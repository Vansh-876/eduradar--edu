<% layout("/layouts/boilerplate") %>
<style>
  .form-control,
    .btn {
      border-radius: 10px;
    }

    .form-control {
      border-radius: 10px;
      border: 1.5px solid #ccc;
      box-shadow: none;
      padding: 0.4rem 0.4rem;
      font-size: 1rem;
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
    }

    .form-control:focus {
      border-color: #6c5ce7;
      box-shadow: 0 0 0 0.15rem rgba(108, 92, 231, 0.25);
      outline: none;
    }

    .form-label {
      font-weight: 500;
      margin-bottom: 0.3rem;
    }
    .btn-primary {
      background-color: #e6b631;
      border-color: #e6b631;
      font-weight: 500;
      padding: 5px 20px;
    }

    .btn-primary:hover {
      background-color: #e0a800;
    }

</style>
<body>
<div class="container pt-5 mt-5 center py-5">
  <h3 class="text-center display-6 fw-bold">Add<span class="text-primary"> New Listings</span></h3>

  <form method="POST" action="/listings" novalidate class="needs-validation" enctype="multipart/form-data">
    
    <!-- Business Title -->
    <div class="mb-3">
      <label class="form-label">Business Title</label>
      <input type="text" class="form-control" name="listing[title]" placeholder="e.g. Elite Book House" required>
      <div class="valid-feedback">Looks good!</div>
      <div class="invalid-feedback">Please enter the business title.</div>
    </div>

    <!-- Business Name -->
    <div class="mb-3">
      <label class="form-label">Business Name</label>
      <input type="text" class="form-control" name="listing[name]" placeholder="e.g. Elite Bookstore Pvt. Ltd." required>
      <div class="valid-feedback">Looks good!</div>
      <div class="invalid-feedback">Please enter the business name.</div>
    </div>

    <!-- Location -->
    <div class="mb-3">
      <label class="form-label">Location</label>
      <input type="text" class="form-control" name="listing[location]" placeholder="e.g. Karol Bagh, Delhi" required>
      <div class="valid-feedback">Looks good!</div>
      <div class="invalid-feedback">Please provide the location.</div>
    </div>

    <!-- Description -->
    <div class="mb-3">
      <label class="form-label">Description</label>
      <textarea class="form-control" rows="3" name="listing[description]" placeholder="Brief description about your business..." required></textarea>
      <div class="valid-feedback">Looks great!</div>
      <div class="invalid-feedback">Please write a short description.</div>
    </div>

    <!-- Image Upload -->
    <div class="mb-3">
      <label class="form-label">Upload Image</label>
      <input type="file" class="form-control" name="listing[image]" required>
      <div class="valid-feedback">Image uploaded.</div>
      <div class="invalid-feedback">Please upload an image.</div>
    </div>


<!-- Category -->
<div class="mb-3">
  <label class="form-label">Category</label>
  <select class="form-select" name="listing[category]" id="category-select" required>
    <option value="">Choose...</option>
    <option>Stationery</option>
    <option>Cyber Cafe</option>
    <option>Library</option>
    <option>Coaching Centre</option>
    <option value="institution">Institution</option>
  </select>
  <div class="valid-feedback">Category selected.</div>
  <div class="invalid-feedback">Please select a category.</div>
</div>

<!-- Subcategory for Institution -->
<div class="mb-3 d-none" id="subcategory-container">
  <label class="form-label">Subcategory (Only for Institutions)</label>
  <select class="form-select" name="listing[subcategory]" id="subcategory-select">
    <option value="">Select Subcategory</option>
    <option value="school">School</option>
    <option value="college">College</option>
    <option value="university">University</option>
  </select>
</div>

<!-- Institution-specific fields -->
<div id="institution-fields" class="d-none">
  <!-- For School -->
  <div class="school-only d-none">
    <div class="mb-3">
      <label class="form-label">Board</label>
      <input type="text" class="form-control" name="listing[board]" placeholder="e.g. CBSE, ICSE">
    </div>
    <div class="row">
      <div class="col-md-6 mb-3">
        <label class="form-label">Classes From</label>
        <input type="text" class="form-control" name="listing[classes_from]" placeholder="e.g. Nursery">
      </div>
      <div class="col-md-6 mb-3">
        <label class="form-label">Classes To</label>
        <input type="text" class="form-control" name="listing[classes_to]" placeholder="e.g. 12th">
      </div>
    </div>
  </div>

  <!-- For College/University -->
  <div class="college-university-only d-none">
    <div class="mb-3">
      <label class="form-label">Affiliation</label>
      <input type="text" class="form-control" name="listing[affiliation]" placeholder="e.g. Delhi University, AKTU">
    </div>
    <div class="mb-3">
      <label class="form-label">Courses Offered (comma separated)</label>
      <input type="text" class="form-control" name="listing[courses_offered]" placeholder="e.g. B.Tech, M.Com, MBA">
    </div>
  </div>
</div>



    <!-- Tags -->
    <div class="mb-3">
      <label for="tags" class="form-label">Tags (comma separated)</label>
      <input type="text" class="form-control" name="listing[tags]" placeholder="e.g. popular, budget friendly, verified">
    </div>
    
    <div class="row">
      <!-- Opening Hours -->
      <div class="col-md-6 mb-3">
        <label class="form-label">Opening Hours</label>
        <input type="text" class="form-control" name="listing[openHours]" placeholder="e.g. 9:00 AM â€“ 9:00 PM" required>
        <div class="valid-feedback">Good hours!</div>
        <div class="invalid-feedback">Please mention the opening hours.</div>
      </div>

      <!-- Contact -->
      <div class="col-md-6 mb-3">
        <label class="form-label">Contact</label>
        <input type="tel" class="form-control" name="listing[contact]" placeholder="e.g. +91 9876543210" required>
        <div class="valid-feedback">Contact looks fine.</div>
        <div class="invalid-feedback">Please provide a contact number.</div>
      </div>
    </div>

    <div class="row">
      <!-- WhatsApp Number -->
      <div class="col-md-6 mb-3">
        <label class="form-label">WhatsApp Number (Optional)</label>
        <input type="tel" class="form-control" name="listing[whatsappNumber]" placeholder="e.g. +91 9876543210">
      </div>

      <!-- Email -->
      <div class="col-md-6 mb-3">
        <label class="form-label">Email</label>
        <input type="email" class="form-control" name="listing[email]" placeholder="e.g. info@example.com" required>
        <div class="invalid-feedback">Please enter a valid email address.</div>
      </div>
    </div>

    <!-- Website -->
    <div class="mb-3">
      <label class="form-label">Website (Optional)</label>
      <input type="url" class="form-control" name="listing[website]" placeholder="e.g. https://yourwebsite.com">
    </div>

    <!-- Google Map Link -->
    <div class="mb-3">
      <label class="form-label">Google Map Link (Optional)</label>
      <input type="url" class="form-control" name="listing[googleMapLink]" placeholder="Paste your map location link">
    </div>

    <div class="row">
      <!-- Facebook Page -->
      <div class="col-md-6 mb-3">
        <label class="form-label">Facebook Page (Optional)</label>
        <input type="url" class="form-control" name="listing[facebookPage]" placeholder="e.g. https://facebook.com/yourpage">
      </div>

      <!-- Instagram Page -->
      <div class="col-md-6 mb-3">
        <label class="form-label">Instagram Page (Optional)</label>
        <input type="url" class="form-control" name="listing[instagramPage]" placeholder="e.g. https://instagram.com/yourpage">
      </div>
    </div>

    <button type="submit" class="btn btn-warning btn-primary d-block mx-auto px-4 mt-4 mb-0">Submit</button>
  </form>
</div>

<script>
  const categorySelect = document.getElementById("category-select");
  const subcategoryContainer = document.getElementById("subcategory-container");
  const subcategorySelect = document.getElementById("subcategory-select");
  const institutionFields = document.getElementById("institution-fields");
  const schoolFields = document.querySelector(".school-only");
  const collegeUniFields = document.querySelector(".college-university-only");

  categorySelect.addEventListener("change", function () {
    if (this.value === "institution") {
      subcategoryContainer.classList.remove("d-none");
    } else {
      subcategoryContainer.classList.add("d-none");
      institutionFields.classList.add("d-none");
      schoolFields.classList.add("d-none");
      collegeUniFields.classList.add("d-none");
    }
  });

  subcategorySelect.addEventListener("change", function () {
    institutionFields.classList.remove("d-none");

    // Reset all
    schoolFields.classList.add("d-none");
    collegeUniFields.classList.add("d-none");

    if (this.value === "school") {
      schoolFields.classList.remove("d-none");
    } else if (this.value === "college" || this.value === "university") {
      collegeUniFields.classList.remove("d-none");
    }
  });
</script>

</body>
